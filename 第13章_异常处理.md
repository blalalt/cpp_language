## 13.1 错误处理

本章包含两部分内容：

* 异常安全保障(exception-safety guarantee)，它是程序从运行时错误中快速恢复的关键
* 使用构造函数和析构函数进行资源管理的资源获取即初始化(Resource Acquisition Is Initialization, RALL)技术。

异常安全保障和资源获取即初始化都依赖于不定式(invariant)的规范。

### 13.1.1 异常

异常的概念可以帮助我们将信息从检测到错误的地方传递到处理该错误的地方。如果函数无法处理某个问题，则抛出(throw)异常，并且寄希望于函数的调用者能直接或间接的处理该问题。函数如果希望处理某个问题，可以捕获(catch)相应的异常：

* 主调组件如果向处理某些失败的情形，可以把这些异常置于try块的catch从句中。
* 被调组件如果无法完成既定任务，可以用throw表达式抛出一个异常来说明这一情况。

```c++
void taksmaster() {
    try {
        auto result = do_task()
    }
    catch (Some_err) {
        // 执行do_task发生错误，处理该问题
    }
}

int do_task() {
    if (/*能够执行该任务*/) {
        return result;
    }
    else {
        throw Some_err{};
    }
}
```



一个被调用的函数不能仅仅报告错误就了事。如果程序想继续运行下去，则该函数返回的同时必须确保程序的状态良好且没有泄露任何资源。

**异常是指被程序抛出的一个对象，表示在程序中出现了一个错误。异常可以是任意类型的对象，只要它能被拷贝即可。**

**最简单定义异常的方法就是　为一种错误定义一个专门的类，当遇到错误时就抛出它**。

异常可以携带一些关于错误的描述信息。异常的类型表示错误的种类，携带的数据记录了错误出现时的情形。

### 13.1.2　传统的错误处理

